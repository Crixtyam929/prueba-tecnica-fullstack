<nav class="navbar">
</nav>

<div class="container">

  <div class="top-actions">
    <button (click)="openCreate()">Crear Registro De Petición</button>
  </div>

  <p *ngIf="errorMessage" class="error">
    {{ errorMessage }}
  </p>

  <div class="cards">
    <div class="card" *ngFor="let log of logs">

      <h3>{{ log.httpMethod }} - {{ log.endpoint }}</h3>

      <p><strong>Date:</strong> {{ log.date }}</p>

      <p>
        <strong>Status:</strong>
        <span
          class="status-badge"
          [ngClass]="{
            'success': log.status >= 200 && log.status < 300,
            'error-status': log.status >= 400
          }"
        >
          {{ log.status }}
        </span>
      </p>

      <p><strong>Response:</strong></p>

      <div class="response-box">
        {{ log.response }}
      </div>

      <div class="card-buttons">
        <button (click)="openEdit(log)">Edit</button>
        <button class="danger" (click)="openDelete(log)">Delete</button>
      </div>

    </div>
  </div>

</div>

<!-- CREATE / EDIT MODAL -->
<div class="modal-backdrop" *ngIf="showEditModal || showCreateModal">
  <div class="modal">
    <h2>{{ showCreateModal ? 'Create Log' : 'Edit Log' }}</h2>

    <label>HTTP Method</label>
    <select [(ngModel)]="selectedLog.httpMethod">
      <option value="">Select method</option>
      <option value="GET">GET</option>
      <option value="POST">POST</option>
      <option value="PUT">PUT</option>
      <option value="DELETE">DELETE</option>
    </select>

    <label>Endpoint</label>
    <input [(ngModel)]="selectedLog.endpoint" />

    <label>Status</label>
    <input
      type="number"
      [(ngModel)]="selectedLog.status"
      min="100"
      max="599"
      maxlength="3"
    />

    <label>Response</label>
    <textarea [(ngModel)]="selectedLog.response"></textarea>

    <div class="modal-actions">
      <button (click)="showCreateModal ? createLog() : updateLog()">
        Save
      </button>
      <button class="danger" (click)="closeModals()">Cancel</button>
    </div>
  </div>
</div>

<!-- VALIDATION MODAL -->
<div class="modal-backdrop top-layer" *ngIf="showValidationModal">
  <div class="modal small">
    <h2>Error</h2>
    <p>{{ validationMessage }}</p>

    <div class="modal-actions">
      <button (click)="showValidationModal = false">OK</button>
    </div>
  </div>
</div>

<!-- DELETE MODAL -->
<div class="modal-backdrop" *ngIf="showDeleteModal">
  <div class="modal">
    <h2>Confirm Delete</h2>
    <p>¿Deseas eliminar este registro?</p>

    <div class="modal-actions">
      <button class="danger" (click)="deleteLog()">Delete</button>
      <button (click)="closeModals()">Cancel</button>
    </div>
  </div>
</div>
